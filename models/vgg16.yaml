---
name: vgg16
dataset:
    background_class: {use: false}
    preprocessed_shape:
        height: 224
        width: 224
        channels: 3
preprocess:
    validate: []
    final:
        - {type: subtract_channel_means}
        - {type: linear_map, scale: 255.0}
hyper:
    - &conv
      type: convolution
      kernel_size: [3, 3]
      stride: 1
      padding: same
      weights_initializer:
          type: tensorflow.truncated_normal_initializer
          stddev: 0.09
      biases_initializer:
          type: tensorflow.constant_initializer
          value: 0.1
      weights_regularizer:
          type: tensorflow.contrib.layers.l2_regularizer
          scale: 0.00004
    - &pool
      type: max_pool
      kernel_size: [2, 2]
      padding: valid
      stride: 2
    - &dropout {type: dropout, keep_prob: 0.5}
    - &fc
      <<: *conv
      kernel_size: [1, 1]
      padding: valid
net:
    - {name: conv1_1, <<: *conv, num_outputs: 64}
    - {name: conv1_2, <<: *conv, num_outputs: 64}
    - {name: pool1, <<: *pool}
    - {name: conv2_1, <<: *conv, num_outputs: 128}
    - {name: conv2_2, <<: *conv, num_outputs: 128}
    - {name: pool2, <<: *pool}
    - {name: conv3_1, <<: *conv, num_outputs: 256}
    - {name: conv3_2, <<: *conv, num_outputs: 256}
    - {name: conv3_3, <<: *conv, num_outputs: 256}
    - {name: pool3, <<: *pool}
    - {name: conv4_1, <<: *conv, num_outputs: 512}
    - {name: conv4_2, <<: *conv, num_outputs: 512}
    - {name: conv4_3, <<: *conv, num_outputs: 512}
    - {name: pool4, <<: *pool}
    - {name: conv5_1, <<: *conv, num_outputs: 512}
    - {name: conv5_2, <<: *conv, num_outputs: 512}
    - {name: conv5_3, <<: *conv, num_outputs: 512}
    - {name: pool5, <<: *pool}
    - {name: fc6, <<: *fc, kernel_size: [7, 7], num_outputs: 4096}
    - {name: dropout6, <<: *dropout}
    - {name: fc7, <<: *fc, num_outputs: 4096}
    - {name: dropout7, <<: *dropout}
    - {name: fc8, <<: *fc, num_outputs: num_classes, activation_fn: null}
    - {name: logits, type: squeeze, axis: [1, 2]}
logits: logits
