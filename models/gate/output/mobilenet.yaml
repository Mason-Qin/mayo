---
_import: ../../mobilenet.yaml
_gate:
  trainable: false
model:
    layers:
        _gated_conv: &gated_conv
            type: gated_convolution
            policy: parametric_gamma
            density: 0.5
            weight: 0.0001
            gate_trainable: true
            should_gate: true
            pool: avg
            normalizer_fn: tensorflow.contrib.slim.batch_norm
            normalizer_params:
                center: true
                scale: true
                decay: 0.9997
                epsilon: 0.001
            trainable: $(_gate.trainable)
        _dsconv: &dsconv
            kwargs: {should_gate: true, trainable: $(_gate.trainable)}
            layers:
                depthwise: {trainable: ^(trainable)}
                pointwise: {<<: *gated_conv, should_gate: ^(should_gate), trainable: ^(trainable)}
        conv0: {<<: *gated_conv}
        conv1: {<<: *dsconv}
        conv2: {<<: *dsconv}
        conv3: {<<: *dsconv}
        conv4: {<<: *dsconv}
        conv5: {<<: *dsconv}
        conv6: {<<: *dsconv}
        conv7: {<<: *dsconv}
        conv8: {<<: *dsconv}
        conv9: {<<: *dsconv}
        conv10: {<<: *dsconv}
        conv11: {<<: *dsconv}
        conv12: {<<: *dsconv}
        conv13: {<<: *dsconv}
        fc: {trainable: $(_gate.trainable)}
